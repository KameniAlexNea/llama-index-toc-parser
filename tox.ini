[tox]
envlist = py310, py311, lint, format, security, type, test
skipsdist = True
skip_missing_interpreters = True

[testenv]
description = Run tests with pytest (base environment, consider removing if 'test' env is primary)
deps = 
    .[test,dev] 
commands =
    pytest tests/ --cov=node_chunker --cov-report=term-missing

[testenv:lint]
description = Run linters
deps =
    .[dev]
commands =
    ruff check node_chunker/ tests/ example/
    black --check node_chunker/ tests/ example/

[testenv:format]
description = Format code with black and ruff
deps = 
    .[dev]
commands =
    black node_chunker/ example/ tests/
    ruff check node_chunker/ example/ tests/ --fix
    ruff format node_chunker/ example/ tests/

[testenv:security]
description = Run security checks
deps =
    .[dev]
commands =
    safety scan

[testenv:type]
description = Run type checks with mypy
deps = 
    .[dev]
commands = mypy node_chunker/

[testenv:test]
description = Run all tests with coverage
deps =
    .[test,dev] # dev includes test, or just .[test] if test deps are self-contained
commands =
    pytest tests/ --cov=node_chunker --cov-report=xml --cov-report=term